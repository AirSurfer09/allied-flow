{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{createRemoteJWKSet,jwtVerify}from\"jose\";import{env}from\"../../config/env.js\";const extractBearerTokenFromHeaders=__name(({authorization})=>{if(!authorization){throw new Error(\"Authorization header is missing\")}if(!authorization.startsWith(\"Bearer\")){throw new Error(\"Authorization header is not in the Bearer scheme\")}return authorization.slice(7)},\"extractBearerTokenFromHeaders\");const jwks=createRemoteJWKSet(new URL(`${env.LOGTO_ENDPOINT}/oidc/jwks`));const extractClaimsFromHeader=__name(async headers=>{const token=extractBearerTokenFromHeaders(headers);const{payload}=await jwtVerify(token,jwks,{issuer:`${env.LOGTO_ENDPOINT}/oidc`,audience:env.LOGTO_AUDIENCE});return payload},\"extractClaimsFromHeader\");export{extractClaimsFromHeader};\n","warnings":[],"map":{"version":3,"mappings":"kHAEA,OAAS,mBAAoB,cAAiB,OAE9C,OAAS,QAAW,sBAEpB,MAAM,8BAAgC,QAAC,CACrC,aACF,IAA2B,CACzB,GAAI,CAAC,cAAe,CAClB,MAAM,IAAI,MAAM,iCAAiC,CACnD,CAEA,GAAI,CAAC,cAAc,WAAW,QAAQ,EAAG,CACvC,MAAM,IAAI,MAAM,kDAAkD,CACpE,CAEA,OAAO,cAAc,MAAM,CAAC,CAC9B,EAZsC,iCAgBtC,MAAM,KAAO,mBAAmB,IAAI,IAAI,GAAG,IAAI,cAAc,YAAY,CAAC,EAEnE,MAAM,wBAA0B,aAAO,SAAiC,CAE7E,MAAM,MAAQ,8BAA8B,OAAO,EAEnD,KAAM,CAAE,OAAQ,EAAI,MAAM,UAExB,MACA,KACA,CAEE,OAAQ,GAAG,IAAI,cAAc,QAE7B,SAAU,IAAI,cAChB,CACF,EAEA,OAAO,OACT,EAjBuC","names":[],"ignoreList":[],"sources":["C:\\Mains\\Programming\\Typescript\\allied-flow\\apps\\server\\src\\services\\auth\\auth.ts"],"sourcesContent":[null]}}